{
  "info": {
    "_postman_id": "71c2e9d9-669f-4db1-b1f1-c85afc72a12e",
    "name": "SONAR",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "12742716"
  },
  "item": [
    {
      "name": "Get Service Hierarchy",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Accept",
            "value": "application/json",
            "type": "text"
          }
        ],
        "url": {
          "raw": "http://localhost:8081/api/v2/config/foo/tenants/baz",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "8081",
          "path": [
            "api",
            "v2",
            "config",
            "foo",
            "tenants",
            "baz"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Create Service Hierarchy",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Accept",
            "value": "application/json",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"services\": [\n        {\n            \"name\": \"my-root\",\n            \"displayName\": \"My Root Service\",\n            \"description\": \"Example root service\",\n            \"url\": null,\n            \"healthChecks\": [\n                {\n                    \"name\": \"RootHealth\",\n                    \"description\": \"Desc\",\n                    \"type\": \"prometheusMetric\",\n                    \"definition\": {\n                        \"duration\": \"08:00:00\",\n                        \"expression\": \"promExpression1\",\n                        \"conditions\": [\n                            {\n                                \"healthOperator\": \"NotEqual\",\n                                \"threshold\": 1.0,\n                                \"healthStatus\": \"Offline\"\n                            }\n                        ]\n                    }\n                },\n                {\n                    \"name\": \"RootHealth2\",\n                    \"type\": \"prometheusMetric\",\n                    \"description\": \"What Another Health Check?\",\n                    \"definition\": {\n                        \"duration\": \"08:00:00\",\n                        \"expression\": \"promExpression2\",\n                        \"conditions\": [\n                            {\n                                \"healthOperator\": \"GreaterThan\",\n                                \"threshold\": 1.0,\n                                \"healthStatus\": \"Online\"\n                            }\n                        ]\n                    }\n                }\n            ],\n            \"children\": [\n                \"my-child\",\n                \"my-child2\"\n            ]\n        },\n        {\n            \"name\": \"my-child\",\n            \"displayName\": \"My Child Service\",\n            \"description\": \"Example child service\",\n            \"url\": null,\n            \"children\": null\n        },\n        {\n            \"name\": \"my-child2\",\n            \"displayName\": \"My Child Service2\",\n            \"description\": \"Example child service2\",\n            \"url\": null,\n            \"children\": null\n        },\n        {\n            \"name\": \"http-metric-test-app\",\n            \"displayName\": \"Test Application for HTTP Health Check\",\n            \"description\": \"A test application that has one endpoint to simulate different HTTP status codes.\",\n            \"url\": \"http://localhost:8082/api/ready\",\n            \"children\": null,\n            \"healthChecks\": [\n                {\n                    \"name\": \"exampleHttpTest\",\n                    \"description\": \"Check to see if request contains failed status code and/or request duration greater than specified threshold.\",\n                    \"definition\": {\n                        \"url\": \"http://localhost:8082/api/ready\",\n                        \"followRedirects\": true,\n                        \"authorizationHeader\": \"test-header\",\n                        \"conditions\": [\n                            {\n                                \"status\": \"Online\",\n                                \"statusCodes\": [\n                                    200\n                                ],\n                                \"type\": \"HttpStatusCode\"\n                            },\n                            {\n                                \"status\": \"Degraded\",\n                                \"responseTime\": \"00:00:02\",\n                                \"type\": \"HttpResponseTime\"\n                            }\n                        ]\n                    },\n                    \"type\": \"httpRequest\"\n                }\n            ]\n        }\n    ],\n    \"rootServices\": [\n        \"my-root\",\n        \"http-metric-test-app\"\n    ]\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "http://localhost:8081/api/v2/config/foo/tenants/baz",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "8081",
          "path": [
            "api",
            "v2",
            "config",
            "foo",
            "tenants",
            "baz"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Update Service Hierarchy",
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Accept",
            "value": "application/json",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"services\": [\n        {\n            \"name\": \"my-root\",\n            \"displayName\": \"My Root Service\",\n            \"description\": \"Example root service\",\n            \"url\": null,\n            \"healthChecks\": [\n                {\n                    \"name\": \"Root-Health2\",\n                    \"description\": \"What Another Health Check?\",\n                    \"definition\": {\n                        \"duration\": \"420.03:14:56.1667000\",\n                        \"expression\": \"Expression\",\n                        \"conditions\": [\n                            {\n                                \"healthOperator\": \"GreaterThan\",\n                                \"threshold\": 1.0,\n                                \"healthStatus\": \"Online\"\n                            }\n                        ]\n                    }\n                }\n            ],\n            \"children\": [\"my-CHILD\"]\n        },\n        {\n            \"name\": \"MY-child\",\n            \"displayName\": \"My Child Service!!!!\",\n            \"description\": \"Example child service NEAT!\",\n            \"url\": null,\n            \"healthChecks\": [\n                {\n                    \"name\": \"Not-RootHealth\",\n                    \"description\": \"Moved from Root\",\n                    \"definition\": {\n                        \"duration\": \"1.03:14:56.1667000\",\n                        \"expression\": \"Not expresso, Expression!!!\",\n                        \"conditions\": [\n                            {\n                                \"healthOperator\": \"NotEqual\",\n                                \"threshold\": 1,\n                                \"healthStatus\": \"Degraded\"\n                            }\n                        ]\n                    }\n                }\n            ],\n            \"children\": [\"sub-SUB-service\"]\n        },\n        {\n            \"name\": \"MY-child2\",\n            \"displayName\": \"My Child Service2!!!!\",\n            \"description\": \"Example child service NEAT2!\",\n            \"url\": null,\n            \"children\": [\"sub-SUB-service\"]\n        },\n        {\n            \"name\": \"sub-sub-service\",\n            \"displayName\": \"New Sub Service\",\n            \"description\": \"Example sub-sub-service.\",\n            \"url\": null,\n            \"children\": []\n        },\n        {\n            \"name\": \"another-root\",\n            \"displayName\": \"My Second Root Service\"\n        }\n    ],\n    \"rootServices\": [\n        \"my-ROOT\",\n        \"another-ROOT\"\n    ]\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "http://localhost:8081/api/v2/config/foo/tenants/baz",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "8081",
          "path": [
            "api",
            "v2",
            "config",
            "foo",
            "tenants",
            "baz"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Create Prometheus Test Data (Root-Health)",
      "request": {
        "method": "POST",
        "header": [],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"MetricName\": \"promExpression1\",\n    \"MetricType\": \"Gauge\",\n    \"HelpText\": \"example help text\",\n    \"Labels\": {\n        \"__name__\": \"promExpression1\",\n        \"foo2\": \"val\"\n    },\n    \"Timeseries\": [\n        [\"2022-11-08T00:09:00Z\", 0.97],\n        [\"2022-11-08T00:09:05Z\", 0.98],\n        [\"2022-11-08T00:09:10Z\", 0.99]\n    ]\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "http://localhost:8081/api/v2/test/data",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "8081",
          "path": [
            "api",
            "v2",
            "test",
            "data"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Create Prometheus Test Data (Root-Health2)",
      "request": {
        "method": "POST",
        "header": [],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"MetricName\": \"promExpression2\",\n    \"MetricType\": \"Gauge\",\n    \"HelpText\": \"example help text\",\n    \"Labels\": {\n        \"__name__\": \"promExpression2\",\n        \"foo2\": \"val\"\n    },\n    \"Timeseries\": [\n       [\"2022-11-08T00:09:00Z\", 1.97],\n        [\"2022-11-08T00:09:05Z\", 1.98],\n        [\"2022-11-08T00:09:10Z\", 1.99]\n    ]\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "http://localhost:8081/api/v2/test/data",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "8081",
          "path": [
            "api",
            "v2",
            "test",
            "data"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Get Prometheus Test Data (promExpression1)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:9090/api/v1/query_range?query=promExpression1&start=2022-11-08T12:09:00Z&end=2022-11-08T12:09:10Z&step=1s",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "9090",
          "path": [
            "api",
            "v1",
            "query_range"
          ],
          "query": [
            {
              "key": "query",
              "value": "promExpression1"
            },
            {
              "key": "start",
              "value": "2022-11-08T12:09:00Z"
            },
            {
              "key": "end",
              "value": "2022-11-08T12:09:10Z"
            },
            {
              "key": "step",
              "value": "1s"
            }
          ]
        }
      },
      "response": []
    },
    {
      "name": "Get Prometheus Test Data (promExpression2)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:9090/api/v1/query_range?query=promExpression2&start=2022-11-08T12:09:00Z&end=2022-11-08T12:09:10Z&step=1s",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "9090",
          "path": [
            "api",
            "v1",
            "query_range"
          ],
          "query": [
            {
              "key": "query",
              "value": "promExpression2"
            },
            {
              "key": "start",
              "value": "2022-11-08T12:09:00Z"
            },
            {
              "key": "end",
              "value": "2022-11-08T12:09:10Z"
            },
            {
              "key": "step",
              "value": "1s"
            }
          ]
        }
      },
      "response": []
    },
    {
      "name": "Create API Key",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Accept",
            "value": "application/json",
            "type": "text"
          },
          {
            "key": "ApiKey",
            "value": "<get from appsettings.json>",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"apikeytype\": \"Standard\",\n    \"environment\": \"foo\",\n    \"tenant\": \"baz\"\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "http://localhost:8081/api/key",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "8081",
          "path": [
            "api",
            "key"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Update API Key",
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Accept",
            "value": "application/json",
            "type": "text"
          },
          {
            "key": "ApiKey",
            "value": "<get from appsettings.json>",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"apikey\": \"<existing API key>\",\n    \"apikeytype\": \"Admin\",\n    \"environment\": \"foo\",\n    \"tenant\": \"baz\"\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "http://localhost:8081/api/key",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "8081",
          "path": [
            "api",
            "key"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Delete API Key",
      "request": {
        "method": "DELETE",
        "header": [
          {
            "key": "Accept",
            "value": "application/json",
            "type": "text"
          },
          {
            "key": "ApiKey",
            "value": "<get from appsettings.json>",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"apikey\": \"<existing API key>\",\n    \"apikeytype\": \"Admin\",\n    \"environment\": \"foo\",\n    \"tenant\": \"baz\"\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "http://localhost:8081/api/key",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "8081",
          "path": [
            "api",
            "key"
          ]
        }
      },
      "response": []
    }
  ]
}
